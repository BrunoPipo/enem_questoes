<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Questões ENEM Matemática</title>
<link rel="icon" href="favicon.png" type="image/png">
<style>
/* ================= BASE ================= */
body {
  font-family: Arial, sans-serif;
  background: #f2f5f8;
  margin: 0;
  color: #263238;
}

/* ================= TOPO ================= */
#topo {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 20px;
  background: linear-gradient(90deg, #1565c0, #1e88e5);
  color: #fff;
}

#autor {
  font-size: 14px;
  font-style: italic;
}

#contador {
  background: rgba(255,255,255,0.15);
  padding: 8px 14px;
  border-radius: 8px;
  font-weight: bold;
}

/* ================= TITULO ================= */
h1 {
  text-align: center;
  margin: 22px 0 10px 0;
  color: #0d47a1;
}

/* ================= CONTROLES ================= */
#controles {
  text-align: center;
  margin-bottom: 10px;
}

#pesquisa, #colunas {
  width: 240px;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #cfd8dc;
  margin: 6px;
  background: #ffffff;
}

#btnInicio {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  background: #1565c0;
  color: #fff;
  cursor: pointer;
}

#btnInicio:hover {
  background: #0d47a1;
}

/* ================= FILTROS ================= */
.secao-filtros {
  margin: 20px;
}

.secao-filtros h3 {
  text-align: center;
  color: #1565c0;
}

.filtros {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
}

.filtro {
  background: #eceff1;
  padding: 8px 12px;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.08);
  cursor: pointer;
}

/* ================= GRID ================= */
#container {
  --cols: 3;
  display: grid;
  grid-template-columns: repeat(var(--cols), 1fr);
  gap: 20px;
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
}

/* ================= QUESTÃO ================= */
.questao {
  background: #ffffff;
  padding: 16px;
  border-radius: 14px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.12);
  border-top: 6px solid #1e88e5;
}

.questao h3 {
  color: #0d47a1;
}

.questao img {
  max-width: 100%;
  margin: 10px 0;
  border-radius: 8px;
}

/* ================= ALTERNATIVAS ================= */
.alternativas {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  margin-top: 12px;
}

.alternativas button {
  height: 42px;
  font-weight: bold;
  border-radius: 6px;
  border: 1px solid #b0bec5;
  background: #e3f2fd;
  cursor: pointer;
  color: #0d47a1;
}

.alternativas button:hover:not(:disabled) {
  background: #bbdefb;
}

.alternativas button.correta {
  background: #2e7d32;
  color: #fff;
  border-color: #2e7d32;
}

.alternativas button.errada {
  background: #c62828;
  color: #fff;
  border-color: #c62828;
}

.alternativas button:disabled {
  cursor: default;
  opacity: 0.95;
}
</style>
</head>

<body>

<div id="topo">
  <div id="autor">
    Criado pelo Mestre em Matemática e Professor de Matemática:
    <strong>Bruno Fabiano Chiodini</strong> — 2026
  </div>
  <div id="contador">
    ✔ Acertos: <span id="acertos">0</span> |
    ✖ Erros: <span id="erros">0</span>
  </div>
</div>

<h1>Questões de Matemática – ENEM</h1>

<div id="controles">
  <input type="text" id="pesquisa" placeholder="Pesquisar: ex 2018 45">

  <select id="colunas">
    <option value="1">1 coluna</option>
    <option value="2">2 colunas</option>
    <option value="3" selected>3 colunas</option>
    <option value="4">4 colunas</option>
  </select>

  <button id="btnInicio">INÍCIO</button>
</div>

<div class="secao-filtros">
  <h3>Filtrar por conteúdo</h3>
  <div id="filtrosConteudo" class="filtros"></div>
</div>

<div class="secao-filtros">
  <h3>Filtrar por ano</h3>
  <div id="filtrosAno" class="filtros"></div>
</div>

<hr>

<div id="container"></div>

<script>
let questoes = [];
let termoPesquisa = "";
let acertos = 0;
let erros = 0;

document.getElementById("colunas").addEventListener("change", e => {
  document.getElementById("container")
    .style.setProperty("--cols", e.target.value);
});

function categoriaPrincipal(texto) {
  texto = texto.toLowerCase();
  if (texto.includes("estatística")) return "Estatística";
  if (texto.includes("função afim")) return "Função Afim";
  if (texto.includes("quadrática")) return "Função Quadrática";
  if (texto.includes("trigonometr")) return "Trigonometria";
  if (texto.includes("analítica")) return "Geometria Analítica";
  if (texto.includes("espacial")) return "Geometria Espacial";
  if (texto.includes("probabilidade")) return "Probabilidade";
  return "Outros";
}

fetch("questoes.csv")
  .then(r => r.text())
  .then(csv => {
    const linhas = csv.trim().split("\n").slice(1);

    const filtrosConteudo = document.getElementById("filtrosConteudo");
    const filtrosAno = document.getElementById("filtrosAno");

    const categorias = new Set();
    const anos = new Set();

    linhas.forEach(l => {
      const [ano, num, conteudos, gabarito] = l.split(";");
      const categoria = categoriaPrincipal(conteudos);

      questoes.push({ ano, num, categoria, gabarito: gabarito.trim() });
      categorias.add(categoria);
      anos.add(ano);
    });

    [...categorias].sort().forEach(c => filtrosConteudo.appendChild(criarCheckbox(c)));
    [...anos].sort((a,b) => b - a).forEach(a => filtrosAno.appendChild(criarCheckbox(a)));

    document.getElementById("pesquisa").addEventListener("input", e => {
      termoPesquisa = e.target.value.toLowerCase();
      aplicarFiltros();
    });

    renderizar(questoes);

    function criarCheckbox(valor) {
      const label = document.createElement("label");
      label.className = "filtro";
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.value = valor;
      cb.addEventListener("change", aplicarFiltros);
      label.appendChild(cb);
      label.appendChild(document.createTextNode(" " + valor));
      return label;
    }

    function aplicarFiltros() {
      const cSel = [...document.querySelectorAll("#filtrosConteudo input:checked")].map(x => x.value);
      const aSel = [...document.querySelectorAll("#filtrosAno input:checked")].map(x => x.value);

      renderizar(
        questoes.filter(q =>
          (cSel.length === 0 || cSel.includes(q.categoria)) &&
          (aSel.length === 0 || aSel.includes(q.ano)) &&
          (termoPesquisa === "" || (`${q.ano} ${q.num}`).toLowerCase().includes(termoPesquisa))
        )
      );
    }
  });

function renderizar(lista) {
  const container = document.getElementById("container");
  container.innerHTML = "";

  lista.forEach(q => {
    const div = document.createElement("div");
    div.className = "questao";

    div.innerHTML = `
      <h3>${q.ano} – Questão ${q.num}</h3>

      <img src="imagens/${q.ano}_q${q.num}.png"
           onerror="this.onerror=null;this.src='imagens/${q.ano}_q${q.num}.PNG';">

      <p><strong>Categoria:</strong> ${q.categoria}</p>

      <div class="alternativas" id="alt_${q.ano}_${q.num}">
        ${["A","B","C","D","E"].map(l =>
          `<button onclick="responder('${q.ano}_${q.num}','${l}','${q.gabarito}')">${l}</button>`
        ).join("")}
      </div>
    `;
    container.appendChild(div);
  });
}

function responder(id, escolha, correta) {
  const botoes = document.querySelectorAll(`#alt_${id} button`);
  if ([...botoes].some(b => b.disabled)) return;

  botoes.forEach(b => {
    b.disabled = true;
    if (b.textContent === correta) b.classList.add("correta");
  });

  const clicado = [...botoes].find(b => b.textContent === escolha);

  if (escolha === correta) acertos++;
  else {
    erros++;
    clicado.classList.add("errada");
  }

  document.getElementById("acertos").textContent = acertos;
  document.getElementById("erros").textContent = erros;
}

document.getElementById("btnInicio").addEventListener("click", () => {
  document.querySelectorAll("input[type=checkbox]").forEach(cb => cb.checked = false);
  document.getElementById("pesquisa").value = "";
  document.getElementById("colunas").value = "3";
  document.getElementById("container").style.setProperty("--cols", 3);

  acertos = 0;
  erros = 0;
  document.getElementById("acertos").textContent = 0;
  document.getElementById("erros").textContent = 0;

  termoPesquisa = "";
  renderizar(questoes);
});
</script>

</body>
</html>
